{
  "id": "5935ced0",
  "title": "PI-WORKTREE-FORKER: Verify and test git worktree functionality",
  "tags": [],
  "status": "open",
  "created_at": "2026-02-12T00:35:01.967Z"
}

Test `pi-worktree-forker` extension to verify it works correctly.

## Extension Overview
The extension intercepts pi fork events to automatically create git worktrees:
1. `session_before_fork` - Prompts user to create worktree or just fork session
2. `session_fork` - Executes git worktree creation if user opted in

## Testing Plan

### Phase 1: Extension Loading Verification
- [ ] Verify extension is loaded (check .pi/extensions symlink exists)
- [ ] Check for any errors during pi startup
- [ ] Confirm `session_before_fork` and `session_fork` hooks are registered

### Phase 2: Basic Functionality Test
- [ ] Test in a Git repository
- [ ] Trigger fork (double-escape or `/fork` command)
- [ ] Verify UI prompt appears with 2 options:
  - "Session Fork only (Default)"
  - "Create Git Worktree + Branch"
- [ ] Select "Session Fork only" - verify normal fork works
- [ ] Select "Create Git Worktree + Branch" - verify worktree is created

### Phase 3: Git Worktree Creation Test
- [ ] Verify git worktree is created as sibling directory (e.g., `repo-fork-timestamp`)
- [ ] Check if branch `pi/fork-timestamp` is created
- [ ] Verify the worktree path is correct
- [ ] Check if `pi.sendMessage` with customType "worktree-fork-info" displays correctly
- [ ] Verify the one-liner command to continue is correct

### Phase 4: Edge Cases
- [ ] Test when NOT in a git repo - should not prompt
- [ ] Test with uncommitted changes - verify git behavior
- [ ] Test multiple forks - verify unique names are generated
- [ ] Test error handling (e.g., git worktree fails)

### Phase 5: Documentation
- [ ] Document what works and what doesn't
- [ ] Identify any bugs or issues
- [ ] Note any improvements needed

## Expected Behavior
When forking with worktree creation:
1. Extension prompts user for choice
2. Git creates new branch `pi/fork-{timestamp}`
3. Git creates worktree at `{repo}-{fork-{timestamp}}`
4. Extension displays info message with directory, branch, and continue command
5. User can continue in new worktree with provided one-liner

## Current Status
Extension is symlinked: `.pi/extensions/pi-worktree-forker -> ../../pi-extensions-dev/pi-worktree-forker`
Source location: `./pi-extensions-dev/pi-worktree-forker/`
Main file: `src/index.ts` (uses `@mariozechner/pi-coding-agent` API)
