{
  "id": "99f816c2",
  "title": "[Phase 1] Self-healing: Error messages with quick-fix remaps",
  "tags": [
    "pi-hash",
    "phase-1",
    "self-healing",
    "error-messages"
  ],
  "status": "closed",
  "created_at": "2026-02-12T21:25:47.709Z",
  "assigned_to_session": "5d994b6f-5c75-4f28-8a94-ed305756b8c1"
}

## Completed

Error messages with quick-fix remaps have been implemented in apply.ts.

### Implementation (mismatch function, lines 182-263)

1. **Build mismatch map** (lines 201-210):
   - For each anchor in the chunk, check if the hash matches at the expected line
   - Store mismatched anchors with expected and actual hashes

2. **Collect context lines** (lines 211-221):
   - Add 2 lines above/below each mismatched line
   - Fallback to around the first anchor if no mismatches found

3. **Build message with >>> markers** (lines 222-244):
   - Show header explaining the error
   - Show context with `>>>` prefix on mismatched lines
   - Show `    ` prefix on unchanged context lines

4. **Add quick-fix remaps** (lines 245-253):
   - Show "Quick fix — replace stale refs:" section
   - List each remap as `5:ab → 5:cd` format

### Example Output

```
Patch Error: Failed to find anchored block in src/file.ts.
1 line has changed since last read. Use the updated LINE:HASH references shown below (>>> marks changed lines).

    1:ef|import { foo }
    2:ij|const y = 2
>>> 3:mn|const x = 1
    4:qr|export { x }

Quick fix — replace stale refs:
	3:ab → 3:mn
```

### Acceptance Criteria Met

- [x] `>>>` marker appears on mismatched lines
- [x] Quick-fix remaps are copy-pasteable
- [x] Context lines shown above/below
